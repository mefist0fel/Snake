<html>
	<head>
		<title>Snake 3d game</title>
		<style type="text/css">
		body {
			display: block;
			background-color:0;
			width: 100%;
			height: 100%;
			margin: 0;
		}
		canvas {
			background-color:0;
			display: block;
			margin: 0px auto;
		}
		</style>
	</head>
	<body>
		<canvas id="snake"></canvas>
	</body>
	<script type="text/javascript">
	
	var aa=Number.MAX_VALUE,ba=Number.MIN_VALUE,da=Math.PI,ea=Math.cos,fa=Math.sin;function ha(b,a,c,d,f,g){return b>=c&&b<=f&&a>=d&&a<=g}function la(b,a){return[b[0]-a[0],b[1]-a[1]]}function ma(b){var a=1/Math.sqrt(b[0]*b[0]+b[1]*b[1]);Infinity==a&&(a=aa);-Infinity==a&&(a=ba);return[b[0]*a,b[1]*a]}function e(b,a,c){return[void 0===b?0:b,void 0===a?0:a,void 0===c?0:c]}function h(b,a){return[b[0]+a[0],b[1]+a[1],b[2]+a[2]]}function l(b,a){return[b[0]-a[0],b[1]-a[1],b[2]-a[2]]}
function n(b,a){return[b[0]*a,b[1]*a,b[2]*a]}function na(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]}function p(b,a){return e(b[1]*a[2]-b[2]*a[1],b[2]*a[0]-b[0]*a[2],b[0]*a[1]-b[1]*a[0])}function r(b){return Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])}function t(b){var a=1/r(b);NaN==a&&(a=aa);Infinity==a&&(a=aa);-Infinity==a&&(a=ba);return n(b,a)}function v(b,a,c){return h(n(b,1-c),n(a,c))}function oa(b){for(var a=e(),c=0;c<b.length;c++)a=h(a,b[c]);return n(a,1/parseFloat(b.length))}
function x(b){var a=(void 0===b?0:b)/180*da;b=ea(a);a=fa(a);return[1,0,0,0,b,-a,0,a,b]}function y(b){var a=(void 0===b?0:b)/180*da;b=ea(a);a=fa(a);return[b,0,a,0,1,0,-a,0,b]}function B(b,a){var c=b[0],d=b[1],f=b[2],g=a/180*da,k=ea(g);g=fa(g);var m=1-k;return[c*c+(1-c*c)*k,c*d*m-f*g,c*f*m+d*g,c*d*m+f*g,d*d+(1-d*d)*k,d*f*m-c*g,c*f*m-d*g,d*f*m+c*g,f*f+(1-f*f)*k]}
function pa(b,a){return[b[0]*a[0]+b[1]*a[3]+b[2]*a[6],b[0]*a[1]+b[1]*a[4]+b[2]*a[7],b[0]*a[2]+b[1]*a[5]+b[2]*a[8],b[3]*a[0]+b[4]*a[3]+b[5]*a[6],b[3]*a[1]+b[4]*a[4]+b[5]*a[7],b[3]*a[2]+b[4]*a[5]+b[5]*a[8],b[6]*a[0]+b[7]*a[3]+b[8]*a[6],b[6]*a[1]+b[7]*a[4]+b[8]*a[7],b[6]*a[2]+b[7]*a[5]+b[8]*a[8]]}function C(b,a){return[b[0]*a[0]+b[1]*a[1]+b[2]*a[2],b[0]*a[3]+b[1]*a[4]+b[2]*a[5],b[0]*a[6]+b[1]*a[7]+b[2]*a[8]]}
function qa(b,a){var c=[b[0],b[1],b[2],1];c=[c[0]*a[0]+c[1]*a[4]+c[2]*a[8]+c[3]*a[12],c[0]*a[1]+c[1]*a[5]+c[2]*a[9]+c[3]*a[13],c[0]*a[2]+c[1]*a[6]+c[2]*a[10]+c[3]*a[14],c[0]*a[3]+c[1]*a[7]+c[2]*a[11]+c[3]*a[15]];return[c[0]/c[3],c[1]/c[3],c[2]/c[3]]}var ra;function D(){for(var b=H,a=0;a<b.s.length;a++)b.s[a].ga(b);b.s.sort(sa);for(a=0;a<b.s.length;a++)b.s[a].ca(b.canvas)}function ta(b,a){var c=h(a,n(b.position,-1));c=C(c,b.K);c=h(c,b.C);c=qa(c,b.ha);c=n(c,b.aa);return h(c,b.S)}
function K(b,a,c){this.position=b;this.o=e();this.color=void 0===c?"#FFEEEE":c;this.$=e(void 0===a?.5:a);this.ia=10;this.enabled=!0;ra.s.push(this)}K.prototype.ga=function(b){if(this.enabled){this.o=ta(b,this.position);var a=h(this.position,n(b.position,-1));a=C(a,b.K);a=h(a,b.C);a=h(a,this.$);a=qa(a,b.ha);a=n(a,b.aa);this.ia=r(l(this.o,h(a,b.S)))}};K.prototype.ca=function(b){this.enabled&&(b.fillStyle=this.color,b.beginPath(),b.arc(this.o[0],this.o[1],this.ia,0,2*Math.PI),b.closePath(),b.fill())};
function L(b,a,c,d,f,g){this.B=[b,a,c];this.m=[b,a,c];this.position=oa(this.B);this.o=e();this.color=void 0===d?"#FFEEEE":d;this.ra=void 0===g?!0:g;this.filled=void 0===f?!0:f;this.enabled=!0;ra.s.push(this)}L.prototype.ga=function(b){if(this.enabled){this.o=ta(b,this.position);for(var a=0;a<this.m.length;a++)this.m[a]=ta(b,this.B[a])}};
L.prototype.ca=function(b){var a;if(a=this.enabled){if(a=this.ra){a=this.m[0];var c=la(this.m[1],a);c=ma([c[1],-c[0]]);a=la(a,this.m[2]);a=0<c[0]*a[0]+c[1]*a[1]}a=!a}if(a){b.fillStyle=this.color;b.strokeStyle=this.color;b.beginPath();a=this.m[this.m.length-1];b.moveTo(a[0],a[1]);for(a=0;a<this.m.length;a++)b.lineTo(this.m[a][0],this.m[a][1]);b.closePath();this.filled&&b.fill();b.stroke()}};function sa(b,a){return b.o[2]<a.o[2]?-1:b.o[2]>a.o[2]?1:0}function ua(){va(this,0)}
function va(b,a){b.id=a;ra.s=[];b.R=null;b.M=3;b.L=0;b.P=6+3*a;b.Y=parseInt(a/4+2);b.F=[];var c=null;if(0==a||a%3==parseInt(a/3)%3)b.Y=0;switch(a%3){case 0:wa();c=xa();break;case 1:var d=void 0===d?11:d;for(var f=[],g=2/d,k=[x(0),x(90),x(180),x(270),y(90),y(270)],m=[.5,.6,.7,.8,.9,1],q=0;q<k.length;q++)for(var z=0;z<d;z++)for(var A=0;A<d;A++){var G=C(n(e(z*g-1,A*g-1,1),4),k[q]);c=C(n(e((z+1)*g-1,A*g-1,1),4),k[q]);var J=C(n(e((z+1)*g-1,(A+1)*g-1,1),4),k[q]),E=C(n(e(z*g-1,(A+1)*g-1,1),4),k[q]),u=parseInt(255*
m[q]),S=parseInt(195*m[q]);u=M(u,u,u);1==(z+A)%2&&(u=M(S,S,S));f.push(new L(G,c,J,u));f.push(new L(G,J,E,u))}f=[e(4.5,4.5,4.5),e(4.5,-4.5,4.5),e(-4.5,4.5,4.5),e(-4.5,-4.5,4.5),e(4.5,4.5,-4.5),e(4.5,-4.5,-4.5),e(-4.5,4.5,-4.5),e(-4.5,-4.5,-4.5)];g=[[0,2,1],[1,2,3],[4,5,6],[5,7,6],[0,6,2],[0,4,6],[1,3,7],[1,7,5],[0,1,5],[0,5,4],[2,6,7],[2,7,3]];k=[];for(m=0;m<g.length;m++)k.push([f[g[m][0]],f[g[m][1]],f[g[m][2]]]);c=k;break;case 2:q=void 0===q?32:q;z=void 0===z?4:z;E=void 0===E?7:E;A=void 0===A?8:A;
G=void 0===G?6:G;d=[];c=[];for(J=0;J<=q;J++)S=C(e(z,0,0),y(360/q*J)),c.push(S);J=e(0,.5*E,0);E=e(0,.5*-E,0);S=1/A;u=1/G;for(var U=0;U<q;U++){for(var I,ca=h(J,c[U]),ia=h(J,c[U+1]),ja=h(E,c[U]),ka=h(E,c[U+1]),w=0;w<G;w++){var F=(G-w)*u*30;I=M(195+F,195+F,195+F);1==(U+w)%2&&(I=M(255-F,255-F,255-F));upperStart=v(J,ca,w*u);upperEnd=v(J,ia,w*u);downerStart=v(J,ca,(w+1)*u);downerEnd=v(J,ia,(w+1)*u);d.push(new L(upperStart,downerEnd,upperEnd,I));d.push(new L(upperStart,downerStart,downerEnd,I))}for(w=0;w<
G;w++)F=(G-w)*u*30,I=M(195+F,195+F,195+F),1==(U+w)%2&&(I=M(255-F,255-F,255-F)),upperStart=v(E,ja,(w+1)*u),upperEnd=v(E,ka,(w+1)*u),downerStart=v(E,ja,w*u),downerEnd=v(E,ka,w*u),d.push(new L(upperStart,downerEnd,upperEnd,I)),d.push(new L(upperStart,downerStart,downerEnd,I));for(w=0;w<A;w++)F=ca[0]/z*.5+.5,I=parseInt(255*(.6*F+.4)),F=parseInt(195*(.6*F+.4)),I=M(I,I,I),1==(U+w)%2&&(I=M(F,F,F)),upperStart=v(ca,ja,w*S),upperEnd=v(ia,ka,w*S),downerStart=v(ca,ja,(w+1)*S),downerEnd=v(ia,ka,(w+1)*S),d.push(new L(upperStart,
downerEnd,upperEnd,I)),d.push(new L(upperStart,downerStart,downerEnd,I))}f=void 0===f?16:f;m=void 0===m?4:m;g=void 0===g?7:g;k=void 0===k?.5:k;q=[];z=[];for(A=0;A<=f;A++)G=C(e(m+k,0,0),y(360/f*A)),z.push(G);m=e(0,.5*g+k,0);g=e(0,.5*-g-k,0);for(k=0;k<f;k++)A=h(m,z[k]),G=h(m,z[k+1]),d=h(g,z[k]),c=h(g,z[k+1]),q.push([m,A,G]),q.push([g,c,d]),q.push([A,c,G]),q.push([A,d,c]);c=q}for(f=0;f<c.length;f++)g=c[f],b.F.push(new ya(g[0],g[1],g[2]));b.c=new za(b.F);b.b=new Aa(b.c);Ba(b.b,!1);b.h=[new N(M(51,255,
51)),new N(M(51,255,51)),new N(M(51,255,51))];b.g=[];for(f=0;f<b.Y;f++)b.g.push(new N(M(0,0,200)))}
ua.prototype.update=function(b){for(var a=0;a<this.h.length;a++)this.h[a].update(b);for(a=0;a<this.g.length;a++)this.g[a].update(b);for(b=0;b<this.h.length;b++)1>r(l(this.c.f,this.h[b].position))&&(this.h[b].remove(Ca(this)),this.b.D+=.5,this.L+=1);for(b=0;b<this.g.length;b++)1>r(l(this.c.f,this.g[b].position))&&(this.g[b].remove(Ca(this)),this.b.D-=.2,--this.M);for(b=6;b<this.b.u.length-1;b++)1>r(l(this.c.f,this.b.u[b]))&&(this.M=0)};
function Ca(b){do{var a=Da(b.c);console.log(a)}while(Ea(b,a));return a}function Ea(b,a){for(var c=0;c<b.h.length;c++)if(1>r(l(a,b.h[c].position)))return!0;for(c=0;c<b.g.length;c++)if(1>r(l(a,b.g[c].position)))return!0;return!1}ua.prototype.start=function(){Ba(this.b,!0);for(var b=0;b<this.h.length;b++)this.h[b].remove(Da(this.c));for(b=0;b<this.g.length;b++)this.g[b].remove(Da(this.c))};
function Fa(){var b=O;Ba(b.b,!1);for(var a=0;a<b.h.length;a++)b.h[a].remove(e());for(a=0;a<b.g.length;a++)b.g[a].remove(e())}function Ga(){var b=O,a=Ha;if(null==b.R){for(var c=[],d=0;d<b.F.length;d++){var f=new L(b.F[d].G,b.F[d].H,b.F[d].I,"rgb(255,255,255)",!1,!1);c.push(f)}c.push(new K(e(8,0,0),.5,M(255,0,0)));c.push(new K(e(0,8,0),.5,M(0,255,0)));c.push(new K(e(0,0,8),.5,M(0,0,255)));b.R=c}for(c=0;c<b.R.length;c++)b.R[c].enabled=a}
function wa(){function b(a,b,c,d,g){return C(n(t(e(a*c-.5,b*c-.5,.5)),d),g)}var a=void 0===a?5:a;var c=void 0===c?9:c;for(var d=[],f=1/c,g=[x(0),x(90),x(180),x(270),y(90),y(270)],k=0;k<g.length;k++)for(var m=0;m<c;m++)for(var q=0;q<c;q++){var z=b(m,q,f,a,g[k]),A=b(m+1,q,f,a,g[k]),G=b(m+1,q+1,f,a,g[k]),J=b(m,q+1,f,a,g[k]),E=.5*b(m+.5,q+.5,f,1,g[k])[0]+.5,u=parseInt(255*(.6*E+.4));E=parseInt(195*(.6*E+.4));u=M(u,u,u);1==(m+q)%2&&(u=M(E,E,E));d.push(new L(z,A,G,u));d.push(new L(z,G,J,u))}}
function xa(){function b(a,b,c,d,g){return C(n(t(e(a*c-.5,b*c-.5,.5)),d),g)}var a=void 0===a?9:a;for(var c=[],d=1/a,f=[x(0),x(90),x(180),x(270),y(90),y(270)],g=0;g<f.length;g++)for(var k=0;k<a;k++)for(var m=0;m<a;m++){var q=b(k,m,d,5.5,f[g]),z=b(k+1,m+1,d,5.5,f[g]),A=b(k,m+1,d,5.5,f[g]);c.push([q,b(k+1,m,d,5.5,f[g]),z]);c.push([q,z,A])}return c}function M(b,a,c,d){function f(a){a=a.toString(16);return 1==a.length?"0"+a:a}return"#"+f(b)+f(a)+f(c)+f(void 0===d?255:d)}
function za(b){this.Z=b=void 0===b?[]:b;this.currentNode=this.Z[0];this.f=this.currentNode.ba;this.A=this.currentNode.ta;for(var a=0;a<b.length;a++)b[a].name=a;for(a=0;a<b.length;a++)for(var c=0;c<b.length;c++)if(a!=c)for(var d=b[a],f=b[c],g=0;g<f.B.length;g++){var k=f.B[g],m=f.B[(g+1)%f.B.length];if(Ia(d.G,d.H,k,m)){d.T=f;break}if(Ia(d.H,d.I,k,m)){d.U=f;break}if(Ia(d.I,d.G,k,m)){d.V=f;break}}}za.prototype.push=function(b){this.va.push(b)};
function Da(b){return b.Z[Math.floor(Math.random()*(b.Z.length-0))+0].ba}za.prototype.moveTo=function(b,a,c){var d=Ja(this.currentNode,b,this.f,a,c);a=l(Ja(this.currentNode,b,h(this.f,this.A),a,c),d);this.currentNode=b;this.f=d;this.A=a};function Ja(b,a,c,d,f){c=l(c,d);f=t(l(f,d));return h(h(d,n(f,na(f,c))),n(p(a.J,f),na(p(b.J,f),c)))}
function ya(b,a,c){this.G=b;this.H=a;this.I=c;this.B=[b,a,c];var d=oa([b,a,c]);this.ba=d;this.J=t(p(l(a,d),l(c,d)));this.ta=t(l(a,d));d=l(a,b);a=l(c,a);b=l(b,c);this.oa=this.G;this.la=t(p(this.J,d));this.pa=this.H;this.ma=t(p(this.J,a));this.qa=this.I;this.na=t(p(this.J,b));this.V=this.U=this.T=null}function Ia(b,a,c,d){return.001>r(l(b,c))&&.001>r(l(a,d))||.001>r(l(b,d))&&.001>r(l(a,c))}
function N(b){var a=e();var c=void 0===c?.4:c;var d=void 0===d?6:d;this.position=a;this.fa=new K(a,0,b);this.sa=c;this.w=0;this.ka=d}N.prototype.remove=function(b){this.position=b;this.w=-Math.abs(this.w)};N.prototype.update=function(b){1>this.w&&(b=this.w+this.ka*b,1<b?b=1:0>this.w&&0<b&&(this.fa.position=this.position),this.w=b,this.fa.$=e(this.sa*Math.abs(this.w)))};
function Aa(b){this.c=b;this.position=b.f;this.da=new K(this.position,.45,M(40,140,40));this.ja=new K(h(this.position,n(b.A,.525)),.1,M(30,130,30));this.rotationAngle=0;this.D=3.5;this.u=[];this.v=[];this.N=this.position;this.enabled=!0}Aa.prototype.rotate=function(b){this.rotationAngle=b};function Ba(b,a){b.enabled=a;b.da.enabled=a;b.ja.enabled=a;for(var c=0;c<b.v.length;c++)b.v[c].enabled=a}
Aa.prototype.update=function(b){var a=140*this.rotationAngle*b,c=this.c;b*=7;b=h(c.f,n(c.A,void 0===b?1:b));var d=c.currentNode;0>na(d.la,l(b,d.oa))?null!=c.currentNode.T&&c.moveTo(c.currentNode.T,c.currentNode.G,c.currentNode.H):(d=c.currentNode,0>na(d.ma,l(b,d.pa))?null!=c.currentNode.U&&c.moveTo(c.currentNode.U,c.currentNode.H,c.currentNode.I):(d=c.currentNode,0>na(d.na,l(b,d.qa))?null!=c.currentNode.V&&c.moveTo(c.currentNode.V,c.currentNode.I,c.currentNode.G):c.f=b));c=this.c;c.A=t(C(c.A,B(c.currentNode.J,
void 0===a?0:a)));this.position=this.c.f;this.da.position=this.c.f;this.ja.position=h(this.c.f,n(this.c.A,.525));a=r(l(this.N,this.position));1<a&&(--a,this.N=h(this.N,t(l(this.position,this.N))),this.u.unshift(this.N),this.u.pop());for(c=this.v.length;c<this.D;c++)this.v.push(new K(e(),0,M(40,Math.max(30,parseInt(142-3*c)),40)));for(c=this.u.length;c<this.v.length+1;c++)this.u.unshift(this.position);for(c=0;c<this.v.length;c++)this.v[c].position=v(this.u[c+1],this.u[c],a),this.v[c].$=e(Math.min(.5,
.25*(this.D-c)))};
var Ka=1/30,La,Na=Ma(),P=document.documentElement.clientWidth,Q=document.documentElement.clientHeight,R=Math.min(P,Q),Oa=0,T=function(){function b(){for(var a=[],b=0;200>b;b++)a[b]=!1;return a}function a(a){f.touches=c(a);a.preventDefault()}function c(a){for(var b=[],c=0;c<a.touches.length;c++)b.push([a.touches[c].clientX,a.touches[c].clientY]);return b}function d(a,b){document.addEventListener(a,b,{passive:!1})}var f={j:b(),a:b(),W:!1,X:!1,l:[0,0],touches:[],O:[],ea:function(a,b,c,d){if(this.W&&
ha(this.l[0],this.l[1],a,b,c,d))return!0;for(var f=0;f<this.touches.length;f++)if(ha(this.touches[f][0],this.touches[f][1],a,b,c,d))return!0;return!1},i:function(a,b,c,d){if(this.X&&ha(this.l[0],this.l[1],a,b,c,d))return!0;for(var f=0;f<this.O.length;f++)if(ha(this.O[f][0],this.O[f][1],a,b,c,d))return!0;return!1},ua:function(){this.X=!1;this.a=b();this.O=[]}};d("mousedown",function(a){f.W=!0;f.X=!0;f.l[0]=a.clientX;f.l[1]=a.clientY});d("mouseup",function(a){f.W=!1;f.l[0]=a.clientX;f.l[1]=a.clientY});
d("mousemove",function(a){f.l[0]=a.clientX;f.l[1]=a.clientY});d("keydown",function(a){f.a[a.keyCode]=!0;f.j[a.keyCode]=!0});d("keyup",function(a){f.j[a.keyCode]=!1});d("touchstart",function(b){f.O=c(b);a(b)});d("touchmove",a);d("touchend",a);d("touchcancel",a);return f}(),Pa=document.getElementById("snake"),V=Pa.getContext("2d"),H=new function(){this.s=[];this.S=e(50,50);this.aa=100;this.K=[1,0,0,0,1,0,0,0,1];this.ha=[1,0,0,0,0,1,0,0,0,0,3,-1,0,0,-4,0];this.C=e(0,0,20);this.position=e();this.canvas=
V;ra=this};Qa();var W=0,X=1,Y=0,Ra=[1,0,0,0,1,0,0,0,1],Sa=t(e(1,1,1)),O=new ua,Ha=!1,Ta=!1;function Ma(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}
function Ua(){var b=.13*R,a=Q-.1*R,c=.12*R;V.fillStyle="#FFFFFF33";V.strokeStyle="#FFFFFF11";V.beginPath();V.arc(b+.2*c,a,.5*c,.838*Math.PI,1.162*Math.PI,!0);V.arc(b+.2*c,a,.3*c,1.3*Math.PI,.7*Math.PI);V.closePath();V.fill();V.stroke();V.beginPath();V.moveTo(b+.04*c-.8*c,a);V.lineTo(b+.04*c-.4*c,a+.4*c);V.lineTo(b+.04*c-.4*c,a+.12*c);V.lineTo(b+.04*c-.04*c,a+.12*c);V.lineTo(b+.04*c-.04*c,a-.12*c);V.lineTo(b+.04*c-.4*c,a-.12*c);V.lineTo(b+.04*c-.4*c,a-.4*c);V.closePath();V.fill();V.stroke()}
function Va(){var b=P-.1*R,a=Q-.1*R,c=.1*R;V.fillStyle="#FFFFFF33";V.strokeStyle="#FFFFFF11";V.beginPath();V.arc(b,a,.6*c,.5*Math.PI,.2*Math.PI);V.arc(b,a,.4*c,.2*Math.PI,.5*Math.PI,!0);V.lineTo(b,a+.3*c);V.lineTo(b+.3*c,a+.5*c);V.lineTo(b,a+.7*c);V.closePath();V.fill();V.stroke()}
function Wa(){var b=P-.1*R,a=Q-.1*R,c=.1*R;V.fillStyle="#FFFFFF33";V.strokeStyle="#FFFFFF11";V.beginPath();V.moveTo(b+.5*c,a);V.lineTo(b,a+.5*c);V.lineTo(b-.5*c,a+.5*c);V.lineTo(b,a);V.lineTo(b-.5*c,a-.5*c);V.lineTo(b,a-.5*c);V.closePath();V.fill();V.stroke()}
function Xa(){var b=.1*R,a=Q-.1*R,c=.1*R;V.fillStyle="#FFFFFF33";V.strokeStyle="#FFFFFF11";V.beginPath();V.moveTo(b-.5*c,a);V.lineTo(b,a+.5*c);V.lineTo(b+.5*c,a+.5*c);V.lineTo(b,a);V.lineTo(b+.5*c,a-.5*c);V.lineTo(b,a-.5*c);V.closePath();V.fill();V.stroke()}function Ya(){var b=P-.1*R,a=.1*R,c=.08*R;V.fillStyle="#FFFFFF33";V.strokeStyle="#FFFFFF11";V.rect(b-.5*c,a+.3*c,c,.2*c);V.rect(b-.5*c,a-.1*c,c,.2*c);V.rect(b-.5*c,a-.5*c,c,.2*c);V.fill();V.stroke()}
function Za(b){var a=Q-.1*R,c=.05*R;c=void 0===c?10:c;V.fillStyle="#FF0000";V.beginPath();V.moveTo(b,a+.5*c);V.arc(b-.175*c,a,.25*c,.75*Math.PI,1.75*Math.PI);V.arc(b+.175*c,a,.25*c,1.25*Math.PI,2.25*Math.PI);V.closePath();V.fill()}function $a(){var b=.1*R,a=.1*R,c=.046*R;c=void 0===c?10:c;V.fillStyle="#33FF33";V.beginPath();V.arc(b,a,.5*c,0,2*Math.PI);V.closePath();V.fill()}
function ab(){var b=t(O.b.position),a=Math.acos(ma([b[0],b[2]])[0])/Math.PI*180,c=Math.acos(b[1])/Math.PI*180-90;a=0<b[2]?a+90:90-a;return[c,a]}function Z(b){switch(b){default:case 0:Ra=H.K;Fa();break;case 4:W=1;break;case 1:break;case 3:if(1!=Oa){for(var a=0;30>a;a++)O.b.update(1/30);O.start()}break;case 5:Fa();Y+=1;break;case 6:Fa()}Oa=b}
function bb(){var b=Ma(),a=(b-Na)/1E3;La=1/a;a>Ka&&(a=Ka);switch(Oa){default:case 0:if(0<W)W-=3*a,0>W&&(W=0),a=2*(W-.5),0<a?H.C=e(30*(1-a*a)*X,0,20):(O.id!=Y&&va(O,Y),H.C=e(30*(-1+a*a)*X,0,20));else{T.a[32]&&Z(4);(T.j[65]||T.j[37])&&0<Y&&(W=1,X=-1,--Y);if(T.j[68]||T.j[39])X=W=1,Y+=1;T.i(0,.5*Q,.3*P,Q)&&0<Y&&(W=1,X=-1,--Y);T.i(.7*P,.5*Q,P,Q)&&(X=W=1,Y+=1);T.i(.4*P,.5*Q,.6*P,Q)&&Z(4);O.update(a);Ra=pa(Ra,B(Sa,20*a));Sa=t(e(100*Sa[0]+(2*Math.random()-1),100*Sa[1]+(2*Math.random()-1),100*Sa[2]+(2*Math.random()-
1)));H.K=Ra;H.position=n(H.position,1-1*a);T.a[113]&&(Ha=!Ha,Ga())}break;case 4:if(0<W){var c=W-1*a;.5>=c&&.5<W&&va(O,Y);W=c;0>W&&(W=0);.5>W&&(O.update(a),H.position=O.b.position,a=ab(),H.K=pa(B(e(1),a[0]),B(e(0,1),a[1])))}else Z(3);break;case 1:T.a[27]&&Z(3);(T.a[65]||T.a[37])&&Z(0);(T.a[68]||T.a[39])&&Z(4);T.i(.7*P,0,P,.3*Q)&&Z(3);T.i(0,.5*Q,.3*P,Q)&&Z(0);T.i(.7*P,.5*Q,P,Q)&&Z(4);break;case 5:if(0<W)W-=3*a,0>W&&(W=0),a=2*(W-.5),0<a?H.C=e(30*(1-a*a)*X,0,15):(O.id!=Y&&va(O,Y),H.C=e(30*(-1+a*a)*X,
0,15));else if(O.id==Y)Z(4);else{T.a[27]&&(--Y,Z(0));T.a[32]&&(X=W=1);if(T.a[65]||T.a[37])--Y,Z(0);if(T.a[68]||T.a[39])X=W=1;T.i(0,.5*Q,.3*P,Q)&&(--Y,Z(0));T.i(.7*P,0,P,Q)&&(X=W=1);O.update(a)}break;case 6:T.a[27]&&Z(0);T.a[32]&&Z(4);(T.a[65]||T.a[37])&&Z(0);(T.a[68]||T.a[39])&&Z(4);T.i(0,.5*Q,.3*P,Q)&&Z(0);T.i(.7*P,0,P,Q)&&Z(0);O.update(a);break;case 3:T.a[27]&&Z(1);T.i(.7*P,0,P,.3*Q)&&Z(1);c=0;if(T.j[65]||T.j[37])c=1;if(T.j[68]||T.j[39])c=-1;T.ea(0,.5*Q,.5*P,Q)&&(c=1);T.ea(.5*P,.5*Q,P,Q)&&(c=-1);
O.b.rotate(c);O.b.update(a);O.update(a);H.position=O.b.position;a=ab();H.K=pa(B(e(1),a[0]),B(e(0,1),a[1]));T.a[113]&&(Ha=!Ha,Ga());O.P<=O.L&&Z(5);0>=O.M&&Z(6)}T.a[115]&&(Ta=!Ta,console.log(ra.s.length));V.fillStyle="#000011";V.fillRect(0,0,P,Q);switch(Oa){default:case 0:D();V.fillStyle="#FFFFFF";V.textAlign="center";V.fillText("Level: "+(Y+1),.5*P,.25*Q-.17*R);V.fillText("need apples: "+O.P,.5*P,.25*Q-.1*R);V.fillText("rocks on level: "+O.Y,.5*P,.25*Q-.03*R);a=.5*P;c=Q-.1*R;var d=.1*R;V.fillStyle=
"#FFFFFF33";V.strokeStyle="#FFFFFF11";V.beginPath();V.arc(a+.2*d,c,.6*d,.75*Math.PI,1.25*Math.PI,!0);V.arc(a+.2*d,c,.4*d,1.25*Math.PI,.75*Math.PI);V.closePath();V.fill();V.stroke();V.beginPath();V.moveTo(a,c);V.lineTo(a-.4*d,c+.4*d);V.lineTo(a-.4*d,c+.12*d);V.lineTo(a-.76*d,c+.12*d);V.lineTo(a-.76*d,c-.12*d);V.lineTo(a-.4*d,c-.12*d);V.lineTo(a-.4*d,c-.4*d);V.closePath();V.fill();V.stroke();Xa();Wa();break;case 1:D();V.fillStyle="#FFFFFF";V.textAlign="center";V.fillText("PAUSE",.5*P,.1*Q);V.textAlign=
"start";V.textBaseline="middle";V.fillText(O.L+"/"+O.P,.15*R,.1*R);$a();for(a=0;a<O.M;a++)Za(.5*P+(a-1)*R*.05);Ya();Ua();Va();break;case 4:D();V.fillStyle=M(0,0,0,parseInt(255*Math.max(0,1-Math.abs(3*W-1.5))));V.fillRect(0,0,P,Q);break;case 3:D();V.fillStyle="#FFFFFF";V.textAlign="start";V.textBaseline="middle";V.fillText(O.L+"/"+O.P,.15*R,.1*R);$a();for(a=0;a<O.M;a++)Za(.5*P+(a-1)*R*.05);Ya();Xa();Wa();break;case 5:D();V.fillStyle="#FFFFFF";V.textAlign="center";V.fillText("YOU WIN!",.5*P,.1*Q);Ua();
Wa();break;case 6:D(),V.fillStyle="#FFFFFF",V.textAlign="center",V.fillText("YOU LOSE!",.5*P,.1*Q),Ua(),Va()}Ta&&(V.textAlign="end",V.fillText("FPS: "+Math.round(La),P-30,50));Na=b;requestAnimationFrame(bb);if(P!=document.documentElement.clientWidth||Q!=document.documentElement.clientHeight)P=document.documentElement.clientWidth,Q=document.documentElement.clientHeight,R=Math.min(P,Q),Qa();T.ua()}requestAnimationFrame(bb);
function Qa(){var b=P,a=Q;Pa.width=b;Pa.height=a;var c=H;c.S=e(.5*b,.5*a);c.aa=Math.min(b,a);c=32;a>b&&(c*=a/b);V.font=parseInt(c)+"pt Arial"};
	
	</script>
</html>