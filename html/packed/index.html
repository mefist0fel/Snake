<html>
	<head>
		<title>Snake 3d game</title>
		<style type="text/css">
		body {
			display: block;
			background-color:0;
			width: 100%;
			height: 100%;
			margin: 0;
		}
		canvas {
			background-color:0;
			display: block;
			margin: 0px auto;
		}
		</style>
	</head>
	<body>
		<canvas id="snake"></canvas>
	</body>
	<script type="text/javascript">var aa=Number.MAX_VALUE,ba=Number.MIN_VALUE,da=Math.PI,ea=Math.cos,fa=Math.sin;function ka(b,a){return[b[0]-a[0],b[1]-a[1]]}function la(b){var a=1/Math.sqrt(b[0]*b[0]+b[1]*b[1]);Infinity==a&&(a=aa);-Infinity==a&&(a=ba);return[b[0]*a,b[1]*a]}function f(b,a,c){return[void 0===b?0:b,void 0===a?0:a,void 0===c?0:c]}function h(b,a){return[b[0]+a[0],b[1]+a[1],b[2]+a[2]]}function m(b,a){return[b[0]-a[0],b[1]-a[1],b[2]-a[2]]}function n(b,a){return[b[0]*a,b[1]*a,b[2]*a]}
function ma(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]}function p(b,a){return f(b[1]*a[2]-b[2]*a[1],b[2]*a[0]-b[0]*a[2],b[0]*a[1]-b[1]*a[0])}function r(b){return Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])}function v(b){var a=1/r(b);NaN==a&&(a=aa);Infinity==a&&(a=aa);-Infinity==a&&(a=ba);return n(b,a)}function w(b,a,c){return h(n(b,1-c),n(a,c))}function na(b){for(var a=f(),c=0;c<b.length;c++)a=h(a,b[c]);return n(a,1/parseFloat(b.length))}
function z(b){var a=(void 0===b?0:b)/180*da;b=ea(a);a=fa(a);return[1,0,0,0,b,-a,0,a,b]}function A(b){var a=(void 0===b?0:b)/180*da;b=ea(a);a=fa(a);return[b,0,a,0,1,0,-a,0,b]}function B(b,a){var c=b[0],d=b[1],e=b[2],g=a/180*da,k=ea(g);g=fa(g);var l=1-k;return[c*c+(1-c*c)*k,c*d*l-e*g,c*e*l+d*g,c*d*l+e*g,d*d+(1-d*d)*k,d*e*l-c*g,c*e*l-d*g,d*e*l+c*g,e*e+(1-e*e)*k]}
function oa(b,a){return[b[0]*a[0]+b[1]*a[3]+b[2]*a[6],b[0]*a[1]+b[1]*a[4]+b[2]*a[7],b[0]*a[2]+b[1]*a[5]+b[2]*a[8],b[3]*a[0]+b[4]*a[3]+b[5]*a[6],b[3]*a[1]+b[4]*a[4]+b[5]*a[7],b[3]*a[2]+b[4]*a[5]+b[5]*a[8],b[6]*a[0]+b[7]*a[3]+b[8]*a[6],b[6]*a[1]+b[7]*a[4]+b[8]*a[7],b[6]*a[2]+b[7]*a[5]+b[8]*a[8]]}function C(b,a){return[b[0]*a[0]+b[1]*a[1]+b[2]*a[2],b[0]*a[3]+b[1]*a[4]+b[2]*a[5],b[0]*a[6]+b[1]*a[7]+b[2]*a[8]]}
function pa(b,a){var c=[b[0],b[1],b[2],1];c=[c[0]*a[0]+c[1]*a[4]+c[2]*a[8]+c[3]*a[12],c[0]*a[1]+c[1]*a[5]+c[2]*a[9]+c[3]*a[13],c[0]*a[2]+c[1]*a[6]+c[2]*a[10]+c[3]*a[14],c[0]*a[3]+c[1]*a[7]+c[2]*a[11]+c[3]*a[15]];return[c[0]/c[3],c[1]/c[3],c[2]/c[3]]}var qa;function I(){for(var b=J,a=0;a<b.j.length;a++)b.j[a].ba(b);b.j.sort(ra);for(a=0;a<b.j.length;a++)b.j[a].Z(b.canvas)}function sa(b,a){var c=h(a,n(b.position,-1));c=C(c,b.I);c=h(c,b.A);c=pa(c,b.ca);c=n(c,b.X);return h(c,b.O)}
function K(b,a,c){this.position=b;this.h=f();this.color=void 0===c?"#FFEEEE":c;this.W=f(void 0===a?.5:a);this.da=10;this.enabled=!0;qa.j.push(this)}K.prototype.ba=function(b){if(this.enabled){this.h=sa(b,this.position);var a=h(this.position,n(b.position,-1));a=C(a,b.I);a=h(a,b.A);a=h(a,this.W);a=pa(a,b.ca);a=n(a,b.X);this.da=r(m(this.h,h(a,b.O)))}};K.prototype.Z=function(b){this.enabled&&(b.fillStyle=this.color,b.beginPath(),b.arc(this.h[0],this.h[1],this.da,0,2*Math.PI),b.closePath(),b.fill())};
function L(b,a,c,d,e,g){this.w=[b,a,c];this.g=[b,a,c];this.position=na(this.w);this.h=f();this.color=void 0===d?"#FFEEEE":d;this.ma=void 0===g?!0:g;this.filled=void 0===e?!0:e;this.enabled=!0;qa.j.push(this)}L.prototype.ba=function(b){if(this.enabled){this.h=sa(b,this.position);for(var a=0;a<this.g.length;a++)this.g[a]=sa(b,this.w[a])}};
L.prototype.Z=function(b){var a;if(a=this.enabled){if(a=this.ma){a=this.g[0];var c=ka(this.g[1],a);c=la([c[1],-c[0]]);a=ka(a,this.g[2]);a=0<c[0]*a[0]+c[1]*a[1]}a=!a}if(a){b.fillStyle=this.color;b.strokeStyle=this.color;b.beginPath();a=this.g[this.g.length-1];b.moveTo(a[0],a[1]);for(a=0;a<this.g.length;a++)b.lineTo(this.g[a][0],this.g[a][1]);b.closePath();this.filled&&b.fill();b.stroke()}};function ra(b,a){return b.h[2]<a.h[2]?-1:b.h[2]>a.h[2]?1:0}function ta(){ua(this,0)}
function ua(b,a){b.id=a;qa.j=[];b.M=null;b.L=3;b.K=0;b.N=6+3*a;b.U=parseInt(a/4+2);b.C=[];var c=null;if(0==a||a%3==parseInt(a/3)%3)b.U=0;switch(a%3){case 0:va();c=wa();break;case 1:var d=void 0===d?11:d;for(var e=[],g=2/d,k=[z(0),z(90),z(180),z(270),A(90),A(270)],l=[.5,.6,.7,.8,.9,1],q=0;q<k.length;q++)for(var x=0;x<d;x++)for(var y=0;y<d;y++){var F=C(n(f(x*g-1,y*g-1,1),4),k[q]);c=C(n(f((x+1)*g-1,y*g-1,1),4),k[q]);var H=C(n(f((x+1)*g-1,(y+1)*g-1,1),4),k[q]),D=C(n(f(x*g-1,(y+1)*g-1,1),4),k[q]),t=parseInt(255*
l[q]),R=parseInt(195*l[q]);t=M(t,t,t);1==(x+y)%2&&(t=M(R,R,R));e.push(new L(F,c,H,t));e.push(new L(F,H,D,t))}e=[f(4.5,4.5,4.5),f(4.5,-4.5,4.5),f(-4.5,4.5,4.5),f(-4.5,-4.5,4.5),f(4.5,4.5,-4.5),f(4.5,-4.5,-4.5),f(-4.5,4.5,-4.5),f(-4.5,-4.5,-4.5)];g=[[0,2,1],[1,2,3],[4,5,6],[5,7,6],[0,6,2],[0,4,6],[1,3,7],[1,7,5],[0,1,5],[0,5,4],[2,6,7],[2,7,3]];k=[];for(l=0;l<g.length;l++)k.push([e[g[l][0]],e[g[l][1]],e[g[l][2]]]);c=k;break;case 2:q=void 0===q?32:q;x=void 0===x?4:x;D=void 0===D?7:D;y=void 0===y?8:y;
F=void 0===F?6:F;d=[];c=[];for(H=0;H<=q;H++)R=C(f(x,0,0),A(360/q*H)),c.push(R);H=f(0,.5*D,0);D=f(0,.5*-D,0);R=1/y;t=1/F;for(var U=0;U<q;U++){for(var G,ca=h(H,c[U]),ha=h(H,c[U+1]),ia=h(D,c[U]),ja=h(D,c[U+1]),u=0;u<F;u++){var E=(F-u)*t*30;G=M(195+E,195+E,195+E);1==(U+u)%2&&(G=M(255-E,255-E,255-E));upperStart=w(H,ca,u*t);upperEnd=w(H,ha,u*t);downerStart=w(H,ca,(u+1)*t);downerEnd=w(H,ha,(u+1)*t);d.push(new L(upperStart,downerEnd,upperEnd,G));d.push(new L(upperStart,downerStart,downerEnd,G))}for(u=0;u<
F;u++)E=(F-u)*t*30,G=M(195+E,195+E,195+E),1==(U+u)%2&&(G=M(255-E,255-E,255-E)),upperStart=w(D,ia,(u+1)*t),upperEnd=w(D,ja,(u+1)*t),downerStart=w(D,ia,u*t),downerEnd=w(D,ja,u*t),d.push(new L(upperStart,downerEnd,upperEnd,G)),d.push(new L(upperStart,downerStart,downerEnd,G));for(u=0;u<y;u++)E=ca[0]/x*.5+.5,G=parseInt(255*(.6*E+.4)),E=parseInt(195*(.6*E+.4)),G=M(G,G,G),1==(U+u)%2&&(G=M(E,E,E)),upperStart=w(ca,ia,u*R),upperEnd=w(ha,ja,u*R),downerStart=w(ca,ia,(u+1)*R),downerEnd=w(ha,ja,(u+1)*R),d.push(new L(upperStart,
downerEnd,upperEnd,G)),d.push(new L(upperStart,downerStart,downerEnd,G))}e=void 0===e?16:e;l=void 0===l?4:l;g=void 0===g?7:g;k=void 0===k?.5:k;q=[];x=[];for(y=0;y<=e;y++)F=C(f(l+k,0,0),A(360/e*y)),x.push(F);l=f(0,.5*g+k,0);g=f(0,.5*-g-k,0);for(k=0;k<e;k++)y=h(l,x[k]),F=h(l,x[k+1]),d=h(g,x[k]),c=h(g,x[k+1]),q.push([l,y,F]),q.push([g,c,d]),q.push([y,c,F]),q.push([y,d,c]);c=q}for(e=0;e<c.length;e++)g=c[e],b.C.push(new xa(g[0],g[1],g[2]));b.a=new ya(b.C);b.b=new za(b.a);Aa(b.b,!1);b.i=[new N(M(51,255,
51)),new N(M(51,255,51)),new N(M(51,255,51))];b.f=[];for(e=0;e<b.U;e++)b.f.push(new N(M(0,0,200)))}
ta.prototype.update=function(b){for(var a=0;a<this.i.length;a++)this.i[a].update(b);for(a=0;a<this.f.length;a++)this.f[a].update(b);for(b=0;b<this.i.length;b++)1>r(m(this.a.c,this.i[b].position))&&(this.i[b].remove(Ba(this.a)),this.b.B+=.5,this.K+=1);for(b=0;b<this.f.length;b++)1>r(m(this.a.c,this.f[b].position))&&(this.f[b].remove(Ba(this.a)),this.b.B-=.2,--this.L);for(b=6;b<this.b.m.length-1;b++)1>r(m(this.a.c,this.b.m[b]))&&(this.L=0)};
ta.prototype.start=function(){Aa(this.b,!0);for(var b=0;b<this.i.length;b++)this.i[b].remove(Ba(this.a));for(b=0;b<this.f.length;b++)this.f[b].remove(Ba(this.a))};function Ca(){var b=O;Aa(b.b,!1);for(var a=0;a<b.i.length;a++)b.i[a].remove(f());for(a=0;a<b.f.length;a++)b.f[a].remove(f())}
function Da(){var b=O,a=Ea;if(null==b.M){for(var c=[],d=0;d<b.C.length;d++){var e=new L(b.C[d].D,b.C[d].F,b.C[d].G,"rgb(255,255,255)",!1,!1);c.push(e)}c.push(new K(f(8,0,0),.5,M(255,0,0)));c.push(new K(f(0,8,0),.5,M(0,255,0)));c.push(new K(f(0,0,8),.5,M(0,0,255)));b.M=c}for(c=0;c<b.M.length;c++)b.M[c].enabled=a}
function va(){function b(a,b,c,d,e){return C(n(v(f(a*c-.5,b*c-.5,.5)),d),e)}var a=void 0===a?5:a;var c=void 0===c?9:c;for(var d=[],e=1/c,g=[z(0),z(90),z(180),z(270),A(90),A(270)],k=0;k<g.length;k++)for(var l=0;l<c;l++)for(var q=0;q<c;q++){var x=b(l,q,e,a,g[k]),y=b(l+1,q,e,a,g[k]),F=b(l+1,q+1,e,a,g[k]),H=b(l,q+1,e,a,g[k]),D=.5*b(l+.5,q+.5,e,1,g[k])[0]+.5,t=parseInt(255*(.6*D+.4));D=parseInt(195*(.6*D+.4));t=M(t,t,t);1==(l+q)%2&&(t=M(D,D,D));d.push(new L(x,y,F,t));d.push(new L(x,F,H,t))}}
function wa(){function b(a,b,c,d,e){return C(n(v(f(a*c-.5,b*c-.5,.5)),d),e)}var a=void 0===a?9:a;for(var c=[],d=1/a,e=[z(0),z(90),z(180),z(270),A(90),A(270)],g=0;g<e.length;g++)for(var k=0;k<a;k++)for(var l=0;l<a;l++){var q=b(k,l,d,5.5,e[g]),x=b(k+1,l+1,d,5.5,e[g]),y=b(k,l+1,d,5.5,e[g]);c.push([q,b(k+1,l,d,5.5,e[g]),x]);c.push([q,x,y])}return c}function M(b,a,c,d){function e(a){a=a.toString(16);return 1==a.length?"0"+a:a}return"#"+e(b)+e(a)+e(c)+e(void 0===d?255:d)}
function ya(b){this.V=b=void 0===b?[]:b;this.currentNode=this.V[0];this.c=this.currentNode.Y;this.u=this.currentNode.oa;for(var a=0;a<b.length;a++)b[a].name=a;for(a=0;a<b.length;a++)for(var c=0;c<b.length;c++)if(a!=c)for(var d=b[a],e=b[c],g=0;g<e.w.length;g++){var k=e.w[g],l=e.w[(g+1)%e.w.length];if(Fa(d.D,d.F,k,l)){d.P=e;break}if(Fa(d.F,d.G,k,l)){d.R=e;break}if(Fa(d.G,d.D,k,l)){d.S=e;break}}}ya.prototype.push=function(b){this.pa.push(b)};
function Ba(b){return b.V[Math.floor(Math.random()*(b.V.length-0))+0].Y}ya.prototype.moveTo=function(b,a,c){var d=Ga(this.currentNode,b,this.c,a,c);a=m(Ga(this.currentNode,b,h(this.c,this.u),a,c),d);this.currentNode=b;this.c=d;this.u=a};function Ga(b,a,c,d,e){c=m(c,d);e=v(m(e,d));return h(h(d,n(e,ma(e,c))),n(p(a.H,e),ma(p(b.H,e),c)))}
function xa(b,a,c){this.D=b;this.F=a;this.G=c;this.w=[b,a,c];var d=na([b,a,c]);this.Y=d;this.H=v(p(m(a,d),m(c,d)));this.oa=v(m(a,d));d=m(a,b);a=m(c,a);b=m(b,c);this.ja=this.D;this.ga=v(p(this.H,d));this.ka=this.F;this.ha=v(p(this.H,a));this.la=this.G;this.ia=v(p(this.H,b));this.S=this.R=this.P=null}function Fa(b,a,c,d){return.001>r(m(b,c))&&.001>r(m(a,d))||.001>r(m(b,d))&&.001>r(m(a,c))}
function N(b){var a=f();var c=void 0===c?.4:c;var d=void 0===d?6:d;this.position=a;this.aa=new K(a,0,b);this.na=c;this.s=0;this.fa=d}N.prototype.remove=function(b){this.position=b;this.s=-Math.abs(this.s)};N.prototype.update=function(b){1>this.s&&(b=this.s+this.fa*b,1<b?b=1:0>this.s&&0<b&&(this.aa.position=this.position),this.s=b,this.aa.W=f(this.na*Math.abs(this.s)))};
function za(b){this.a=b;this.position=b.c;this.$=new K(this.position,.45,M(40,140,40));this.ea=new K(h(this.position,n(b.u,.525)),.1,M(30,130,30));this.rotationAngle=0;this.B=3.5;this.m=[];this.o=[];this.J=this.position;this.enabled=!0}za.prototype.rotate=function(b){this.rotationAngle=b};function Aa(b,a){b.enabled=a;b.$.enabled=a;b.ea.enabled=a;for(var c=0;c<b.o.length;c++)b.o[c].enabled=a}
za.prototype.update=function(b){var a=140*this.rotationAngle*b,c=this.a;b*=7;b=h(c.c,n(c.u,void 0===b?1:b));var d=c.currentNode;0>ma(d.ga,m(b,d.ja))?null!=c.currentNode.P&&c.moveTo(c.currentNode.P,c.currentNode.D,c.currentNode.F):(d=c.currentNode,0>ma(d.ha,m(b,d.ka))?null!=c.currentNode.R&&c.moveTo(c.currentNode.R,c.currentNode.F,c.currentNode.G):(d=c.currentNode,0>ma(d.ia,m(b,d.la))?null!=c.currentNode.S&&c.moveTo(c.currentNode.S,c.currentNode.G,c.currentNode.D):c.c=b));c=this.a;c.u=v(C(c.u,B(c.currentNode.H,
void 0===a?0:a)));this.position=this.a.c;this.$.position=this.a.c;this.ea.position=h(this.a.c,n(this.a.u,.525));a=r(m(this.J,this.position));1<a&&(--a,this.J=h(this.J,v(m(this.position,this.J))),this.m.unshift(this.J),this.m.pop());for(c=this.o.length;c<this.B;c++)this.o.push(new K(f(),0,M(40,Math.max(30,parseInt(142-3*c)),40)));for(c=this.m.length;c<this.o.length+1;c++)this.m.unshift(this.position);for(c=0;c<this.o.length;c++)this.o[c].position=w(this.m[c+1],this.m[c],a),this.o[c].W=f(Math.min(.5,
.25*(this.B-c)))};
var Ha=1/30,Ia,Ka=Ja(),P=document.documentElement.clientWidth,Q=document.documentElement.clientHeight,S=Math.min(P,Q),La=0,T=function(){function b(a){c.touches=[];for(var b=0;b<a.touches.length;b++)c.touches.push([a.touches[b].clientX,a.touches[b].clientY]);a.preventDefault()}function a(a,b){document.addEventListener(a,b,{passive:!1})}for(var c={key:[200],T:!1,l:[0,0],touches:[],v:function(a,b,c,d){var e;if(e=this.T){e=this.l[0];var g=this.l[1];e=e>=a&&e<=c&&g>=b&&g<=d}if(e)return!0;for(e=0;e<this.touches.length;e++){g=
this.touches[e][0];var k=this.touches[e][1];if(g>=a&&g<=c&&k>=b&&k<=d)return!0}return!1}},d=0;200>d;d++)c.key[d]=!1;a("keydown",function(a){c.key[a.keyCode]=!0});a("keyup",function(a){c.key[a.keyCode]=!1});a("click",function(){});a("mousedown",function(a){c.T=!0;c.l[0]=a.clientX;c.l[1]=a.clientY});a("mouseup",function(a){c.T=!1;c.l[0]=a.clientX;c.l[1]=a.clientY});a("mousemove",function(a){c.l[0]=a.clientX;c.l[1]=a.clientY});a("touchstart",b);a("touchmove",b);a("touchend",b);a("touchcancel",b);return c}(),
Ma=document.getElementById("snake"),V=Ma.getContext("2d"),J=new function(){this.j=[];this.O=f(50,50);this.X=100;this.I=[1,0,0,0,1,0,0,0,1];this.ca=[1,0,0,0,0,1,0,0,0,0,3,-1,0,0,-4,0];this.A=f(0,0,20);this.position=f();this.canvas=V;qa=this};Na();var W=0,X=1,Y=0,Oa=[1,0,0,0,1,0,0,0,1],Pa=v(f(1,1,1)),O=new ta,Ea=!1,Qa=!1;function Ja(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}
function Ra(){var b=P-.1*S,a=Q-.1*S,c=.1*S;V.fillStyle="#FFFFFF33";V.strokeStyle="#FFFFFF11";V.beginPath();V.moveTo(b+.5*c,a);V.lineTo(b,a+.5*c);V.lineTo(b-.5*c,a+.5*c);V.lineTo(b,a);V.lineTo(b-.5*c,a-.5*c);V.lineTo(b,a-.5*c);V.closePath();V.fill();V.stroke()}
function Sa(){var b=.1*S,a=Q-.1*S,c=.1*S;V.fillStyle="#FFFFFF33";V.strokeStyle="#FFFFFF11";V.beginPath();V.moveTo(b-.5*c,a);V.lineTo(b,a+.5*c);V.lineTo(b+.5*c,a+.5*c);V.lineTo(b,a);V.lineTo(b+.5*c,a-.5*c);V.lineTo(b,a-.5*c);V.closePath();V.fill();V.stroke()}function Ta(){var b=v(O.b.position),a=Math.acos(la([b[0],b[2]])[0])/Math.PI*180,c=Math.acos(b[1])/Math.PI*180-90;a=0<b[2]?a+90:90-a;return[c,a]}
function Z(b){La=b;switch(La){default:case 0:Oa=J.I;Ca();break;case 4:W=1;break;case 1:break;case 3:for(b=0;30>b;b++)O.b.update(1/30);O.start();break;case 5:Ca();Y+=1;break;case 6:Ca()}}
function Ua(){var b=Ja(),a=(b-Ka)/1E3;Ia=1/a;a>Ha&&(a=Ha);switch(La){default:case 0:if(0<W)W-=3*a,0>W&&(W=0),a=2*(W-.5),0<a?J.A=f(30*(1-a*a)*X,0,20):(O.id!=Y&&ua(O,Y),J.A=f(30*(-1+a*a)*X,0,20));else{T.key[32]&&(T.key[32]=!1,Z(4));(T.key[65]||T.key[37])&&0<Y&&(W=1,X=-1,--Y);if(T.key[68]||T.key[39])X=W=1,Y+=1;T.v(0,.5*Q,.3*P,Q)&&0<Y&&(W=1,X=-1,--Y);T.v(.7*P,.5*Q,P,Q)&&(X=W=1,Y+=1);T.v(.4*P,.5*Q,.6*P,Q)&&Z(4);O.update(a);Oa=oa(Oa,B(Pa,20*a));Pa=v(f(100*Pa[0]+(2*Math.random()-1),100*Pa[1]+(2*Math.random()-
1),100*Pa[2]+(2*Math.random()-1)));J.I=Oa;J.position=n(J.position,1-1*a);T.key[113]&&(T.key[113]=!1,Ea=!Ea,Da())}break;case 4:if(0<W){var c=W-1*a;.5>=c&&.5<W&&ua(O,Y);W=c;0>W&&(W=0);.5>W&&(O.update(a),J.position=O.b.position,a=Ta(),J.I=oa(B(f(1),a[0]),B(f(0,1),a[1])))}else Z(3);break;case 1:T.key[27]&&(T.key[27]=!1,Z(3));T.key[81]&&(T.key[81]=!1,Z(0));break;case 3:T.key[27]&&(T.key[27]=!1,Z(1));c=0;if(T.key[65]||T.key[37])c=1;if(T.key[68]||T.key[39])c=-1;T.v(0,0,.5*P,Q)&&(c=1);T.v(.5*P,0,P,Q)&&(c=
-1);O.b.rotate(c);O.b.update(a);O.update(a);J.position=O.b.position;a=Ta();J.I=oa(B(f(1),a[0]),B(f(0,1),a[1]));T.key[113]&&(T.key[113]=!1,Ea=!Ea,Da());O.N<=O.K&&Z(5);0>=O.L&&Z(6);break;case 5:0<W?(W-=3*a,0>W&&(W=0),a=2*(W-.5),0<a?J.A=f(30*(1-a*a)*X,0,15):(O.id!=Y&&ua(O,Y),J.A=f(30*(-1+a*a)*X,0,15))):O.id==Y?Z(4):(T.key[27]&&(T.key[27]=!1,--Y,Z(0)),T.key[32]&&(T.key[32]=!1,X=W=1),T.v(0,0,P,Q)&&(X=W=1),O.update(a));break;case 6:T.key[27]&&(T.key[27]=!1,Z(0)),T.key[32]&&(T.key[32]=!1,Z(4)),T.v(0,0,P,
Q)&&Z(0),O.update(a)}T.key[115]&&(T.key[115]=!1,Qa=!Qa,console.log(qa.j.length));V.fillStyle="#000011";V.fillRect(0,0,P,Q);switch(La){default:case 0:I();V.fillStyle="#FFFFFF";V.textAlign="center";V.fillText("Level: "+Y,.5*P,.25*Q-.17*S);V.fillText("need apples: "+O.N,.5*P,.25*Q-.1*S);V.fillText("rocks on level: "+O.U,.5*P,.25*Q-.03*S);a=.5*P;c=Q-.1*S;var d=.1*S;V.fillStyle="#FFFFFF33";V.strokeStyle="#FFFFFF11";V.beginPath();V.arc(a,c,.6*d,0,2*Math.PI);V.arc(a,c,.46*d,0,2*Math.PI,!0);V.closePath();
V.fill();V.beginPath();V.arc(a,c,.6*d,0,2*Math.PI);V.closePath();V.stroke();V.beginPath();V.moveTo(a+.36*d,c);V.lineTo(a-.24*d,c+.28*d);V.lineTo(a-.24*d,c-.28*d);V.closePath();V.fill();V.stroke();Sa();Ra();break;case 1:I();V.fillStyle="#FFFFFF";V.textAlign="center";V.fillText("PAUSE ",.5*P,.5*Q-.4*S);V.fillText("Q to quit ",.5*P,.5*Q+.4*S);V.fillText("Esc to continue ",.5*P,.5*Q+.45*S);break;case 4:I();V.fillStyle=M(0,0,0,parseInt(255*Math.max(0,1-Math.abs(3*W-1.5))));V.fillRect(0,0,P,Q);break;case 3:I();
V.fillStyle="#FFFFFF";V.textAlign="start";V.textBaseline="middle";V.fillText(O.K+"/"+O.N,.15*S,.1*S);a=.1*S;c=.1*S;d=.046*S;d=void 0===d?10:d;V.fillStyle="#33FF33";V.beginPath();V.arc(a,c,.5*d,0,2*Math.PI);V.closePath();V.fill();for(a=0;a<O.L;a++){c=.5*P+(a-1)*S*.05;d=.95*Q;var e=.05*S;e=void 0===e?10:e;V.fillStyle="#FF0000";V.beginPath();V.moveTo(c,d+.5*e);V.arc(c-.175*e,d,.25*e,.75*Math.PI,1.75*Math.PI);V.arc(c+.175*e,d,.25*e,1.25*Math.PI,2.25*Math.PI);V.closePath();V.fill()}Sa();Ra();break;case 5:I();
V.fillStyle="#FFFFFF";V.textAlign="center";V.fillText("YOU WIN!",.5*P,.1*Q);V.fillText("space to next level",.5*P,.85*Q);V.fillText("esc to level selection",.5*P,.95*Q);break;case 6:I(),V.fillStyle="#FFFFFF",V.textAlign="center",V.fillText("YOU LOSE!",.5*P,.1*Q),V.fillText("space to retry",.5*P,.85*Q),V.fillText("esc to level selection",.5*P,.95*Q)}Qa&&(V.textAlign="end",V.fillText("FPS: "+Math.round(Ia),P-30,50));Ka=b;requestAnimationFrame(Ua);if(P!=document.documentElement.clientWidth||Q!=document.documentElement.clientHeight)P=
document.documentElement.clientWidth,Q=document.documentElement.clientHeight,S=Math.min(P,Q),Na()}requestAnimationFrame(Ua);function Na(){var b=P,a=Q;Ma.width=b;Ma.height=a;var c=32;a>b&&(c*=b/a);V.font=parseInt(c)+"pt Arial";c=J;c.O=f(.5*b,.5*a);c.X=Math.min(b,a)};
	</script>
</html>