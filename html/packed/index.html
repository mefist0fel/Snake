<html>
	<head>
		<title>Snake 3d game</title>
		<style type="text/css">
		body {
			display: block;
			background-color:0;
			width: 100%;
			height: 100%;
			margin: 0;
		}
		canvas {
			background-color:#000000;
			display: block;
			margin: 0px auto;
		}
		</style>
	</head>
	<body>
		<canvas id="snake"></canvas>
	</body>
	<script type="text/javascript">
function aa(a,b){var c=g.l[0],d=g.l[1],e=.5*l,f=1*l;return c>=a&&c<=b&&d>=e&&d<=f}function ba(a,b){return[a[0]-b[0],a[1]-b[1]]}function da(a){var b=1/Math.sqrt(a[0]*a[0]+a[1]*a[1]);Infinity==b&&(b=Number.MAX_VALUE);-Infinity==b&&(b=Number.MIN_VALUE);return[a[0]*b,a[1]*b]}function m(a,b,c){return[void 0===a?0:a,void 0===b?0:b,void 0===c?0:c]}function p(a,b){return[a[0]+b[0],a[1]+b[1],a[2]+b[2]]}function q(a,b){return[a[0]-b[0],a[1]-b[1],a[2]-b[2]]}function t(a,b){return[a[0]*b,a[1]*b,a[2]*b]}
function ea(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function v(a,b){return m(a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0])}function y(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])}function z(a){var b=1/y(a);NaN==b&&(b=Number.MAX_VALUE);Infinity==b&&(b=Number.MAX_VALUE);-Infinity==b&&(b=Number.MIN_VALUE);return t(a,b)}function A(a,b,c){return p(t(a,1-c),t(b,c))}function fa(a){for(var b=m(),c=0;c<a.length;c++)b=p(b,a[c]);return t(b,1/parseFloat(a.length))}
function B(a){var b=(void 0===a?0:a)/180*Math.PI;a=Math.cos(b);b=Math.sin(b);return[1,0,0,0,a,-b,0,b,a]}function E(a){var b=(void 0===a?0:a)/180*Math.PI;a=Math.cos(b);b=Math.sin(b);return[a,0,b,0,1,0,-b,0,a]}function I(a,b){var c=a[0],d=a[1],e=a[2],f=b/180*Math.PI,h=Math.cos(f);f=Math.sin(f);var k=1-h;return[c*c+(1-c*c)*h,c*d*k-e*f,c*e*k+d*f,c*d*k+e*f,d*d+(1-d*d)*h,d*e*k-c*f,c*e*k-d*f,d*e*k+c*f,e*e+(1-e*e)*h]}
function ka(a,b){return[a[0]*b[0]+a[1]*b[3]+a[2]*b[6],a[0]*b[1]+a[1]*b[4]+a[2]*b[7],a[0]*b[2]+a[1]*b[5]+a[2]*b[8],a[3]*b[0]+a[4]*b[3]+a[5]*b[6],a[3]*b[1]+a[4]*b[4]+a[5]*b[7],a[3]*b[2]+a[4]*b[5]+a[5]*b[8],a[6]*b[0]+a[7]*b[3]+a[8]*b[6],a[6]*b[1]+a[7]*b[4]+a[8]*b[7],a[6]*b[2]+a[7]*b[5]+a[8]*b[8]]}function J(a,b){return[a[0]*b[0]+a[1]*b[1]+a[2]*b[2],a[0]*b[3]+a[1]*b[4]+a[2]*b[5],a[0]*b[6]+a[1]*b[7]+a[2]*b[8]]}
function la(a,b){var c=[a[0],a[1],a[2],1];c=[c[0]*b[0]+c[1]*b[4]+c[2]*b[8]+c[3]*b[12],c[0]*b[1]+c[1]*b[5]+c[2]*b[9]+c[3]*b[13],c[0]*b[2]+c[1]*b[6]+c[2]*b[10]+c[3]*b[14],c[0]*b[3]+c[1]*b[7]+c[2]*b[11]+c[3]*b[15]];return[c[0]/c[3],c[1]/c[3],c[2]/c[3]]}var ma;function K(){for(var a=L,b=0;b<a.j.length;b++)a.j[b].aa(a);a.j.sort(na);for(b=0;b<a.j.length;b++)a.j[b].Y(a.canvas)}function oa(a,b){var c=p(b,t(a.position,-1));c=J(c,a.H);c=p(c,a.w);c=la(c,a.ba);c=t(c,a.W);return p(c,a.N)}
function M(a,b,c){this.position=a;this.h=m();this.color=void 0===c?"#FFEEEE":c;this.V=m(void 0===b?.5:b);this.ca=10;this.enabled=!0;ma.j.push(this)}M.prototype.aa=function(a){if(this.enabled){this.h=oa(a,this.position);var b=p(this.position,t(a.position,-1));b=J(b,a.H);b=p(b,a.w);b=p(b,this.V);b=la(b,a.ba);b=t(b,a.W);this.ca=y(q(this.h,p(b,a.N)))}};M.prototype.Y=function(a){this.enabled&&(a.fillStyle=this.color,a.beginPath(),a.arc(this.h[0],this.h[1],this.ca,0,2*Math.PI),a.closePath(),a.fill())};
function N(a,b,c,d,e,f){this.v=[a,b,c];this.g=[a,b,c];this.position=fa(this.v);this.h=m();this.color=void 0===d?"#FFEEEE":d;this.la=void 0===f?!0:f;this.filled=void 0===e?!0:e;this.enabled=!0;ma.j.push(this)}N.prototype.aa=function(a){if(this.enabled){this.h=oa(a,this.position);for(var b=0;b<this.g.length;b++)this.g[b]=oa(a,this.v[b])}};
N.prototype.Y=function(a){var b;if(b=this.enabled){if(b=this.la){b=this.g[0];var c=ba(this.g[1],b);c=da([c[1],-c[0]]);b=ba(b,this.g[2]);b=0<c[0]*b[0]+c[1]*b[1]}b=!b}if(b){a.fillStyle=this.color;a.strokeStyle=this.color;a.beginPath();b=this.g[this.g.length-1];a.moveTo(b[0],b[1]);for(b=0;b<this.g.length;b++)a.lineTo(this.g[b][0],this.g[b][1]);a.closePath();this.filled&&a.fill();a.stroke()}};function na(a,b){return a.h[2]<b.h[2]?-1:a.h[2]>b.h[2]?1:0}function pa(){qa(this,0)}
function qa(a,b){a.id=b;ma.j=[];a.L=null;a.K=3;a.J=0;a.M=6+3*b;a.T=parseInt(b/4+2);a.B=[];var c=null;if(0==b||b%3==parseInt(b/3)%3)a.T=0;switch(b%3){case 0:ra();c=sa();break;case 1:var d=void 0===d?11:d;for(var e=[],f=2/d,h=[B(0),B(90),B(180),B(270),E(90),E(270)],k=[.5,.6,.7,.8,.9,1],n=0;n<h.length;n++)for(var w=0;w<d;w++)for(var x=0;x<d;x++){var F=J(t(m(w*f-1,x*f-1,1),4),h[n]);c=J(t(m((w+1)*f-1,x*f-1,1),4),h[n]);var H=J(t(m((w+1)*f-1,(x+1)*f-1,1),4),h[n]),C=J(t(m(w*f-1,(x+1)*f-1,1),4),h[n]),r=parseInt(255*
k[n]),U=parseInt(195*k[n]);r=O(r,r,r);1==(w+x)%2&&(r=O(U,U,U));e.push(new N(F,c,H,r));e.push(new N(F,H,C,r))}e=[m(4.5,4.5,4.5),m(4.5,-4.5,4.5),m(-4.5,4.5,4.5),m(-4.5,-4.5,4.5),m(4.5,4.5,-4.5),m(4.5,-4.5,-4.5),m(-4.5,4.5,-4.5),m(-4.5,-4.5,-4.5)];f=[[0,2,1],[1,2,3],[4,5,6],[5,7,6],[0,6,2],[0,4,6],[1,3,7],[1,7,5],[0,1,5],[0,5,4],[2,6,7],[2,7,3]];h=[];for(k=0;k<f.length;k++)h.push([e[f[k][0]],e[f[k][1]],e[f[k][2]]]);c=h;break;case 2:n=void 0===n?32:n;w=void 0===w?4:w;C=void 0===C?7:C;x=void 0===x?8:x;
F=void 0===F?6:F;d=[];c=[];for(H=0;H<=n;H++)c.push(J(m(w,0,0),E(360/n*H)));H=m(0,.5*C,0);C=m(0,.5*-C,0);U=1/x;r=1/F;for(var S=0;S<n;S++){for(var G,ca=p(H,c[S]),ha=p(H,c[S+1]),ia=p(C,c[S]),ja=p(C,c[S+1]),u=0;u<F;u++){var D=(F-u)*r*30;G=O(195+D,195+D,195+D);1==(S+u)%2&&(G=O(255-D,255-D,255-D));upperStart=A(H,ca,u*r);upperEnd=A(H,ha,u*r);downerStart=A(H,ca,(u+1)*r);downerEnd=A(H,ha,(u+1)*r);d.push(new N(upperStart,downerEnd,upperEnd,G));d.push(new N(upperStart,downerStart,downerEnd,G))}for(u=0;u<F;u++)D=
(F-u)*r*30,G=O(195+D,195+D,195+D),1==(S+u)%2&&(G=O(255-D,255-D,255-D)),upperStart=A(C,ia,(u+1)*r),upperEnd=A(C,ja,(u+1)*r),downerStart=A(C,ia,u*r),downerEnd=A(C,ja,u*r),d.push(new N(upperStart,downerEnd,upperEnd,G)),d.push(new N(upperStart,downerStart,downerEnd,G));for(u=0;u<x;u++)D=ca[0]/w*.5+.5,G=parseInt(255*(.6*D+.4)),D=parseInt(195*(.6*D+.4)),G=O(G,G,G),1==(S+u)%2&&(G=O(D,D,D)),upperStart=A(ca,ia,u*U),upperEnd=A(ha,ja,u*U),downerStart=A(ca,ia,(u+1)*U),downerEnd=A(ha,ja,(u+1)*U),d.push(new N(upperStart,
downerEnd,upperEnd,G)),d.push(new N(upperStart,downerStart,downerEnd,G))}e=void 0===e?16:e;k=void 0===k?4:k;f=void 0===f?7:f;h=void 0===h?.5:h;n=[];w=[];for(x=0;x<=e;x++)w.push(J(m(k+h,0,0),E(360/e*x)));k=m(0,.5*f+h,0);f=m(0,.5*-f-h,0);for(h=0;h<e;h++)x=p(k,w[h]),F=p(k,w[h+1]),d=p(f,w[h]),c=p(f,w[h+1]),n.push([k,x,F]),n.push([f,c,d]),n.push([x,c,F]),n.push([x,d,c]);c=n}for(e=0;e<c.length;e++)f=c[e],a.B.push(new ta(f[0],f[1],f[2]));a.a=new ua(a.B);a.b=new va(a.a);wa(a.b,!1);a.i=[new P(O(255,0,0)),
new P(O(255,0,0)),new P(O(255,0,0))];a.f=[];for(e=0;e<a.T;e++)a.f.push(new P(O(0,0,200)))}
pa.prototype.update=function(a){for(var b=0;b<this.i.length;b++)this.i[b].update(a);for(b=0;b<this.f.length;b++)this.f[b].update(a);for(a=0;a<this.i.length;a++)1>y(q(this.a.c,this.i[a].position))&&(this.i[a].remove(xa(this.a)),this.b.A+=.5,this.J+=1);for(a=0;a<this.f.length;a++)1>y(q(this.a.c,this.f[a].position))&&(this.f[a].remove(xa(this.a)),this.b.A-=.2,--this.K);for(a=6;a<this.b.m.length-1;a++)1>y(q(this.a.c,this.b.m[a]))&&(this.K=0)};
pa.prototype.start=function(){wa(this.b,!0);for(var a=0;a<this.i.length;a++)this.i[a].remove(xa(this.a));for(a=0;a<this.f.length;a++)this.f[a].remove(xa(this.a))};function ya(){var a=Q;wa(a.b,!1);for(var b=0;b<a.i.length;b++)a.i[b].remove(m());for(b=0;b<a.f.length;b++)a.f[b].remove(m())}
function za(){var a=Q,b=Aa;if(null==a.L){for(var c=[],d=0;d<a.B.length;d++){var e=new N(a.B[d].C,a.B[d].D,a.B[d].F,"rgb(255,255,255)",!1,!1);c.push(e)}c.push(new M(m(8,0,0),.5,O(255,0,0)));c.push(new M(m(0,8,0),.5,O(0,255,0)));c.push(new M(m(0,0,8),.5,O(0,0,255)));a.L=c}for(c=0;c<a.L.length;c++)a.L[c].enabled=b}
function ra(){function a(a,b,c,d,e){return J(t(z(m(a*c-.5,b*c-.5,.5)),d),e)}var b=void 0===b?5:b;var c=void 0===c?9:c;for(var d=[],e=1/c,f=[B(0),B(90),B(180),B(270),E(90),E(270)],h=0;h<f.length;h++)for(var k=0;k<c;k++)for(var n=0;n<c;n++){var w=a(k,n,e,b,f[h]),x=a(k+1,n,e,b,f[h]),F=a(k+1,n+1,e,b,f[h]),H=a(k,n+1,e,b,f[h]),C=.5*a(k+.5,n+.5,e,1,f[h])[0]+.5,r=parseInt(255*(.6*C+.4));C=parseInt(195*(.6*C+.4));r=O(r,r,r);1==(k+n)%2&&(r=O(C,C,C));d.push(new N(w,x,F,r));d.push(new N(w,F,H,r))}}
function sa(){function a(a,b,c,d,e){return J(t(z(m(a*c-.5,b*c-.5,.5)),d),e)}var b=void 0===b?9:b;for(var c=[],d=1/b,e=[B(0),B(90),B(180),B(270),E(90),E(270)],f=0;f<e.length;f++)for(var h=0;h<b;h++)for(var k=0;k<b;k++){var n=a(h,k,d,5.5,e[f]),w=a(h+1,k+1,d,5.5,e[f]),x=a(h,k+1,d,5.5,e[f]);c.push([n,a(h+1,k,d,5.5,e[f]),w]);c.push([n,w,x])}return c}function O(a,b,c,d){function e(a){a=a.toString(16);return 1==a.length?"0"+a:a}return"#"+e(a)+e(b)+e(c)+e(void 0===d?255:d)}
function ua(a){this.U=a=void 0===a?[]:a;this.currentNode=this.U[0];this.c=this.currentNode.X;this.u=this.currentNode.na;for(var b=0;b<a.length;b++)a[b].name=b;for(b=0;b<a.length;b++)for(var c=0;c<a.length;c++)if(b!=c)for(var d=a[b],e=a[c],f=0;f<e.v.length;f++){var h=e.v[f],k=e.v[(f+1)%e.v.length];if(Ba(d.C,d.D,h,k)){d.O=e;break}if(Ba(d.D,d.F,h,k)){d.P=e;break}if(Ba(d.F,d.C,h,k)){d.R=e;break}}}ua.prototype.push=function(a){this.oa.push(a)};
function xa(a){return a.U[Math.floor(Math.random()*(a.U.length-0))+0].X}ua.prototype.moveTo=function(a,b,c){var d=Ca(this.currentNode,a,this.c,b,c);b=q(Ca(this.currentNode,a,p(this.c,this.u),b,c),d);this.currentNode=a;this.c=d;this.u=b};function Ca(a,b,c,d,e){c=q(c,d);e=z(q(e,d));return p(p(d,t(e,ea(e,c))),t(v(b.G,e),ea(v(a.G,e),c)))}
function ta(a,b,c){this.C=a;this.D=b;this.F=c;this.v=[a,b,c];var d=fa([a,b,c]);this.X=d;this.G=z(v(q(b,d),q(c,d)));this.na=z(q(b,d));d=q(b,a);b=q(c,b);a=q(a,c);this.ia=this.C;this.fa=z(v(this.G,d));this.ja=this.D;this.ga=z(v(this.G,b));this.ka=this.F;this.ha=z(v(this.G,a));this.R=this.P=this.O=null}function Ba(a,b,c,d){return.001>y(q(a,c))&&.001>y(q(b,d))||.001>y(q(a,d))&&.001>y(q(b,c))}
function P(a){var b=m();var c=void 0===c?.4:c;var d=void 0===d?6:d;this.position=b;this.$=new M(b,0,a);this.ma=c;this.s=0;this.ea=d}P.prototype.remove=function(a){this.position=a;this.s=-Math.abs(this.s)};P.prototype.update=function(a){1>this.s&&(a=this.s+this.ea*a,1<a?a=1:0>this.s&&0<a&&(this.$.position=this.position),this.s=a,this.$.V=m(this.ma*Math.abs(this.s)))};
function va(a){this.a=a;this.position=a.c;this.Z=new M(this.position,.45,O(40,140,40));this.da=new M(p(this.position,t(a.u,.525)),.1,O(30,130,30));this.rotationAngle=0;this.A=3.5;this.m=[];this.o=[];this.I=this.position;this.enabled=!0}va.prototype.rotate=function(a){this.rotationAngle=a};function wa(a,b){a.enabled=b;a.Z.enabled=b;a.da.enabled=b;for(var c=0;c<a.o.length;c++)a.o[c].enabled=b}
va.prototype.update=function(a){var b=140*this.rotationAngle*a,c=this.a;a*=7;a=p(c.c,t(c.u,void 0===a?1:a));var d=c.currentNode;0>ea(d.fa,q(a,d.ia))?null!=c.currentNode.O&&c.moveTo(c.currentNode.O,c.currentNode.C,c.currentNode.D):(d=c.currentNode,0>ea(d.ga,q(a,d.ja))?null!=c.currentNode.P&&c.moveTo(c.currentNode.P,c.currentNode.D,c.currentNode.F):(d=c.currentNode,0>ea(d.ha,q(a,d.ka))?null!=c.currentNode.R&&c.moveTo(c.currentNode.R,c.currentNode.F,c.currentNode.C):c.c=a));c=this.a;c.u=z(J(c.u,I(c.currentNode.G,
void 0===b?0:b)));this.position=this.a.c;this.Z.position=this.a.c;this.da.position=p(this.a.c,t(this.a.u,.525));b=y(q(this.I,this.position));1<b&&(--b,this.I=p(this.I,z(q(this.position,this.I))),this.m.unshift(this.I),this.m.pop());for(c=this.o.length;c<this.A;c++)this.o.push(new M(m(),0,O(40,Math.max(30,parseInt(142-3*c)),40)));for(c=this.m.length;c<this.o.length+1;c++)this.m.unshift(this.position);for(c=0;c<this.o.length;c++)this.o[c].position=A(this.m[c+1],this.m[c],b),this.o[c].V=m(Math.min(.5,
.25*(this.A-c)))};
var Da=1/30,Ea,Ga=Fa(),R=document.documentElement.clientWidth,l=document.documentElement.clientHeight,T=Math.min(R,l),Ha=0,g=function(){for(var a={key:[200],S:!1,l:[0,0]},b=0;200>b;b++)a.key[b]=!1;document.addEventListener("keydown",function(b){a.key[b.keyCode]=!0},!1);document.addEventListener("keyup",function(b){a.key[b.keyCode]=!1},!1);document.addEventListener("click",function(){},!1);document.addEventListener("mousedown",function(b){a.S=!0;a.l[0]=b.clientX;a.l[1]=b.clientY},!1);document.addEventListener("mouseup",
function(b){a.S=!1;a.l[0]=b.clientX;a.l[1]=b.clientY},!1);document.addEventListener("mousemove",function(b){a.l[0]=b.clientX;a.l[1]=b.clientY},!1);document.addEventListener("touchstart",function(){},!1);document.addEventListener("touchmove",function(){},!1);document.addEventListener("touchend",function(){},!1);document.addEventListener("touchcancel",function(){},!1);return a}(),Ia=document.getElementById("snake"),V=Ia.getContext("2d"),L=new function(){this.j=[];this.N=m(50,50);this.W=100;this.H=[1,
0,0,0,1,0,0,0,1];this.ba=[1,0,0,0,0,1,0,0,0,0,3,-1,0,0,-4,0];this.w=m(0,0,15);this.position=m();this.canvas=V;ma=this};Ja();var W=0,X=1,Y=0,Ka=[1,0,0,0,1,0,0,0,1],La=z(m(1,1,1)),Q=new pa,Aa=!1,Ma=!1;function Fa(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function Na(){var a=z(Q.b.position),b=Math.acos(da([a[0],a[2]])[0])/Math.PI*180,c=Math.acos(a[1])/Math.PI*180-90;b=0<a[2]?b+90:90-b;return[c,b]}
function Z(a){Ha=a;switch(Ha){default:case 0:Ka=L.H;ya();break;case 4:W=1;break;case 1:break;case 3:for(a=0;30>a;a++)Q.b.update(1/30);Q.start();break;case 5:ya();Y+=1;break;case 6:ya()}}
function Oa(){var a=Fa(),b=(a-Ga)/1E3;Ea=1/b;b>Da&&(b=Da);switch(Ha){default:case 0:if(0<W)W-=3*b,0>W&&(W=0),b=2*(W-.5),0<b?L.w=m(30*(1-b*b)*X,0,15):(Q.id!=Y&&qa(Q,Y),L.w=m(30*(-1+b*b)*X,0,15));else{g.key[32]&&(g.key[32]=!1,Z(4));(g.key[65]||g.key[37])&&0<Y&&(W=1,X=-1,--Y);if(g.key[68]||g.key[39])X=W=1,Y+=1;Q.update(b);Ka=ka(Ka,I(La,20*b));La=z(m(100*La[0]+(2*Math.random()-1),100*La[1]+(2*Math.random()-1),100*La[2]+(2*Math.random()-1)));L.H=Ka;L.position=t(L.position,1-1*b);g.key[113]&&(g.key[113]=
!1,Aa=!Aa,za())}break;case 4:if(0<W){var c=W-1*b;.5>=c&&.5<W&&qa(Q,Y);W=c;0>W&&(W=0);.5>W&&(Q.update(b),L.position=Q.b.position,b=Na(),L.H=ka(I(m(1),b[0]),I(m(0,1),b[1])))}else Z(3);break;case 1:g.key[27]&&(g.key[27]=!1,Z(3));g.key[81]&&(g.key[81]=!1,Z(0));break;case 3:g.key[27]&&(g.key[27]=!1,Z(1));c=0;if(g.key[65]||g.key[37])c=1;if(g.key[68]||g.key[39])c=-1;g.S&&(aa(0,.3*R)&&(c=1),aa(.7*R,1*R)&&(c=-1));Q.b.rotate(c);Q.b.update(b);Q.update(b);L.position=Q.b.position;b=Na();L.H=ka(I(m(1),b[0]),I(m(0,
1),b[1]));g.key[113]&&(g.key[113]=!1,Aa=!Aa,za());Q.M<=Q.J&&Z(5);0>=Q.K&&Z(6);break;case 5:0<W?(W-=3*b,0>W&&(W=0),b=2*(W-.5),0<b?L.w=m(30*(1-b*b)*X,0,15):(Q.id!=Y&&qa(Q,Y),L.w=m(30*(-1+b*b)*X,0,15))):Q.id==Y?Z(4):(g.key[27]&&(g.key[27]=!1,--Y,Z(0)),g.key[32]&&(g.key[32]=!1,X=W=1),Q.update(b));break;case 6:g.key[27]&&(g.key[27]=!1,Z(0)),g.key[32]&&(g.key[32]=!1,Z(4)),Q.update(b)}g.key[115]&&(g.key[115]=!1,Ma=!Ma,console.log(ma.j.length));V.fillStyle="#000011";V.font="16pt Arial";V.fillRect(0,0,R,l);
switch(Ha){default:case 0:K();V.fillStyle="#FFFFFF";V.textAlign="center";V.fillText("Level: "+Y,.5*R,.5*l-.46*T);V.fillText("need apples: "+Q.M,.5*R,.5*l-.42*T);V.fillText("rocks on level: "+Q.T,.5*R,.5*l-.38*T);V.fillText("<< to select level >>",.5*R,.5*l+.4*T);V.fillText("space to start",.5*R,.5*l+.45*T);break;case 1:K();V.fillStyle="#FFFFFF";V.textAlign="center";V.fillText("PAUSE ",.5*R,.5*l-.4*T);V.fillText("Q to quit ",.5*R,.5*l+.4*T);V.fillText("Esc to continue ",.5*R,.5*l+.45*T);break;case 4:K();
V.fillStyle=O(0,0,0,parseInt(255*Math.max(0,1-Math.abs(3*W-1.5))));V.fillRect(0,0,R,l);break;case 3:K();V.fillStyle="#FFFFFF";V.textAlign="start";V.fillText("Apples: "+Q.J+"/"+Q.M,.5*R-.5*T,.5*l-.45*T);V.fillText("lives: "+Q.K,.5*R-.5*T,.5*l-.4*T);break;case 5:K();V.fillStyle="#FFFFFF";V.textAlign="center";V.fillText("YOU WIN!",.5*R,.5*l-.4*T);V.fillText("space to next level",.5*R,.5*l+.4*T);V.fillText("esc to level selection",.5*R,.5*l+.45*T);break;case 6:K(),V.fillStyle="#FFFFFF",V.textAlign="center",
V.fillText("YOU LOSE!",.5*R,.5*l-.4*T),V.fillText("space to retry",.5*R,.5*l+.4*T),V.fillText("esc to level selection",.5*R,.5*l+.45*T)}Ma&&(V.fillText("FPS:",R-120,50),V.textAlign="end",V.fillText(parseInt(Ea),R-30,50));Ga=a;requestAnimationFrame(Oa);if(R!=document.documentElement.clientWidth||l!=document.documentElement.clientHeight)R=document.documentElement.clientWidth,l=document.documentElement.clientHeight,T=Math.min(R,l),Ja()}requestAnimationFrame(Oa);
function Ja(){var a=R,b=l;Ia.width=a;Ia.height=b;var c=L;c.N=m(.5*a,.5*b);c.W=Math.min(a,b)};
	</script>
</html>